let e=[],t=0,l=0,r=r=>{let f=[],o={get:()=>(o.lc||o.listen(()=>{})(),o.value),lc:0,listen:l=>(o.lc=f.push(l),()=>{for(let r=t+4;r<e.length;)e[r]===l?e.splice(r,4):r+=4;let r=f.indexOf(l);~r&&(f.splice(r,1),--o.lc||o.off())}),notify(r,n){l++;let i=!e.length;for(let t of f)e.push(t,o.value,r,n);if(i){for(t=0;t<e.length;t+=4)e[t](e[t+1],e[t+2],e[t+3]);e.length=0}},off(){},set(e){let t=o.value;t!==e&&(o.value=e,o.notify(t))},subscribe(e){let t=o.listen(e);return e(o.value),t},value:r};return o};var f=r(null),o=r("en");(e=>{Array.isArray(e)||(e=[e]);let t,f,o=()=>{if(f===l)return;f=l;let r=e.map(e=>e.get());if(!t||r.some((e,l)=>e!==t[l])){t=r;let e=((e,t)=>e??t)(...r);e&&e.then&&e.t?e.then(e=>{t===r&&n.set(e)}):(n.set(e),f=l)}},n=r(void 0),i=n.get;n.get=()=>(o(),i());let u=o;((e,t)=>{((e,t,l,r)=>{e.events=e.events||{},e.events[15]||(e.events[15]=r(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(t)})(e,l=>{let r=t();r&&e.events[6].push(r)},0,t=>{let l=e.listen;e.listen=(...r)=>(!e.lc&&!e.active&&(e.active=!0,t()),l(...r));let r=e.off;return e.events[6]=[],e.off=()=>{r(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let t of e.events[6])t();e.events[6]=[]}},1e3)},()=>{e.listen=l,e.off=r}})})(n,()=>{let t=e.map(e=>e.listen(u));return o(),()=>{for(let e of t)e()}})})([f,o]);var n=r({});function i(e,t){f.set(e),o.set(e),t&&n.set(t)}function u(e){n.set(e)}export{i,u as s};